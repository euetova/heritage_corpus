{% extends "base.html" %}
{% load dajaxice_templatetags %}
{% load staticfiles %}
{% load i18n %}
{% load annotator_tags %}
{% block title %}{% trans 'Russian Learner Corpus Annotation' %}{% endblock %}
{% block meta_content %}{% trans 'Annotation' %}{% endblock %}

{% block scripts %}
{% for i in j %}
     <script>
    {{ i|safe }}
    </script>
    {% endfor %}

{% endblock %}
    {% block upper-row %}
            {% endblock %}

    {% block other %}

 <link rel="stylesheet" href="{% static "css/custom-theme/jquery-ui-1.9.2.custom.css" %}" />
  <script src="{% static "js/jquery-ui-1.9.2.custom.min.js" %}"></script>
        <style>
        .ui-autocomplete { position: absolute; cursor: default;z-index:30000 !important;}
        </style>
<script type="text/javascript">
$(document).ready(function(){
    $(".token[title*='bastard']").css( "text-decoration", "underline" );
});
 function search(id) {
$.get("/RLC/document-annotations/get_correction_by_id/"+id,
                    function (data) {
                        $("#"+id+"+").html(data[1]);
                        $("#second"+id).html(data[0]);
                    });
            return false;
        }
</script>

    {% endblock %}

{% block content_header %}{% trans 'Annotate text' %}{% endblock content_header %}
{% block content %}
    {% if alert %}
                  <div class="alert alert-warning alert-dismissible small" role="alert">
  <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
  <strong>Warning!</strong>
</div>
              {% endif %}

     <div class="col-md-10">
    {% for doc, sents in data %}
    <div class="row">
      <div class="col-md-6">
          <h2>
        <span class="lead">{% trans 'Annotate text' %}:</span> <strong>{{doc}}</strong>

    </h2>
      </div>
      <div class="col-md-6">
      <div class="row">
          <h2 align="right">
          <div class="col-md-offset-4 col-md-3">
              {% if doc.annotated %}
                  {% if request.user|has_group:"STAFF"%}
              {% if not doc.checked %}
                  <form action="mark" method="POST">
                  <input type="hidden" name="next" value="{{ request.get_full_path }}" />
                <button type="submit" class="btn btn-warning btn-sm" value="checked" name="mark">
                  <span class="glyphicon glyphicon-ok" aria-hidden="true"></span> {% trans 'Checked' %}
                </button></form>
              {% endif %}
                      {% if doc.checked %}
                  <form action="mark" method="POST">
                  <input type="hidden" name="next" value="{{ request.get_full_path }}" />
                <button type="submit" class="btn btn-warning btn-sm" value="unchecked" name="mark">
                  <span class="glyphicon glyphicon-remove" aria-hidden="true"></span> {% trans 'Not checked' %}
                </button></form>
              {% endif %}
                  {% endif %}
          {% endif %}
          </div>
          <div class="col-md-3">
              {% if not doc.annotated %}
              <form action="mark" method="POST">
              <input type="hidden" name="next" value="{{ request.get_full_path }}" />
                 <button type="submit" class="btn btn-warning btn-sm" value="annotated" name="mark">
                  <span class="glyphicon glyphicon-thumbs-up" aria-hidden="true"></span> {% trans 'Annotated' %}
                </button>
              </form></h2>
      {% endif %}
      {% if doc.annotated %}
              <form action="mark" method="POST">
              <input type="hidden" name="next" value="{{ request.get_full_path }}" />
                 <button type="submit" class="btn btn-warning btn-sm" value="unannotated" name="mark">
                  <span class="glyphicon glyphicon-thumbs-down" aria-hidden="true"></span> {% trans 'Not annotated' %}
                </button>
              </form></h2>
      {% endif %}
      </div>

      </div>
      </div>

	<div class="row">
            {% for sent in sents %}
                <span id="{{ sent.id }}" class="original_sentence" contenteditable="false">
                    {{sent.tagged|safe|linebreaksbr}}
                </span>
                <span class="correct_sentence"  id = "{{ sent.id }}+" contenteditable="false">
                    {{sent.correct|safe|linebreaksbr}}
                </span><br>
                <span class="correct_sentence"  id = "second{{ sent.id }}" contenteditable="false">
                    {{sent.correct|safe|linebreaksbr}}
                </span><br><br>
            {% endfor %}
    </div>
{% endfor %}
    <div class="btn-group" role="group">

    <a class="btn btn-default btn-sm" href="/RLC/download_file/{{ doc_id }}/ann" role="button">{% trans 'Download annotation as csv' %}</a>
    <a class="btn btn-default  btn-sm" href="/RLC/download_file/{{ doc_id }}/tokens" role="button">{% trans 'Download text as csv' %}</a>
        <a class="btn btn-default  btn-sm" href="/RLC/download_file/{{ doc_id }}/text" role="button">{% trans 'Download plain text' %}</a>
     <button type="button" class="btn btn-default  btn-sm" data-toggle="modal" data-target="#upload_csv">{% trans "Upload annotation" %}</button>

    </div>
</div>

    <div class="modal fade" tabindex="-1" role="dialog" id="upload_csv">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">{% trans 'Загрузить файл с разметкой' %}</h4>
      </div>
      <div class="modal-body">
        <form action="handle_upload" method="post" enctype="multipart/form-data">
            <input type="hidden" name="next" value="{{ request.get_full_path }}" />
  <div class="form-group">
    <label for="exampleInputFile">{% trans 'CSV с разметкой' %}</label>
    <input type="file" name="InputFile">
    <p class="help-block">{% trans 'Выберите файл с разметкой. Убедитесь, что файл сохранен в кодировке utf-8.' %}</p>
  </div>
             <div class="checkbox">
    <label>
      <input type="checkbox" name="has_headers"> {% trans 'В файле есть строка заголовков.' %}
    </label>
  </div>
  <button type="submit" class="btn btn-default">{% trans 'Загрузить' %}</button>
</form>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

	<div class="col-md-2">
    <div class="row" style="padding-top:20px; line-height: 1; font-size:80%">
<h4 class="well well-sm">Error tags</h4>
  <ul class="nav nav-stacked well well-sm">
    <li>Orthography
    <ul>
        <li>Graph</li>
        <li>Hyphen</li>
        <li>Space</li>
        <li>Ortho</li>
        <li>Translit</li>
        <li>Misspell</li>
    </ul></li>
    <li>Morphology 
    <ul>
        <li>Deriv</li>
        <li>Infl</li>
        <li>Num</li>
        <li>Gender</li>
        <li>Morph</li>
    </ul></li>
    <li>Syntax
    <ul>
        <li>Asp</li>
        <li>ArgStr</li>
        <li>Passive</li>
        <li>Reflec</li>
        <li>AgrNum</li>
        <li>AgrCase</li>
		<li>AgrGender</li>
        <li>AgrPers</li>
        <li>AgrGerund</li>
        <li>Gov</li>
        <li>Ref</li>
        <li>Conj</li>
		<li>WO</li>
        <li>Neg</li>
        <li>Aux</li>
        <li>Brev</li>
        <li>Syntax</li>
	</ul></li>
    <li>Construction
    <ul>
        <li>Constr</li>
    </ul></li>
    <li>Lexis
    <ul>
	    <li>Lex</li>
        <li>CS</li>
        <li>Par</li>
		<li>Idiom</li>
	</ul></li>
	<li>Additional tags
	<ul>
	    <li>Transfer</li>
		<li>Not-clear</li>
		<li>Del</li>
		<li>Insert</li>
		<li>Transp</li>
		<li>Subst</li>
	</ul></li>
  </ul>
    </div>
    </div>
{% endblock %}